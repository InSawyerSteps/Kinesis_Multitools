{
    "pattern_name": "path_safety_within_registered_roots",
    "description": "Path sandboxing helper to ensure an absolute path is within one of the registered project roots.",
    "language": "python",
    "file_path": "c:\\Projects\\MCP Server\\src\\toolz.py",
    "locator": {
        "type": "function_name",
        "function_name": "_is_safe_path"
    },
    "extraction_strategy": "python_ast",
    "source_code": "def _is_safe_path(path: pathlib.Path) -> bool:\n    \"\"\"Ensure *path* is inside one of the PROJECT_ROOTS roots.\"\"\"\n    try:\n        resolved_path = path.resolve()\n        for root in PROJECT_ROOTS.values():\n            if resolved_path.is_relative_to(root.resolve()):\n                return True\n    except (OSError, ValueError):  # Catches resolution errors or invalid paths\n        return False\n    return False",
    "created_at": "2025-08-10T05:36:41Z",
    "updated_at": "2025-08-10T05:36:41Z",
    "source_file": "c:\\Projects\\MCP Server\\src\\toolz.py",
    "function_name": "_is_safe_path",
    "added_at_utc": "2025-08-10T05:36:41Z"
}